@model List<SyndicateIT.Model.ViewModel.Exam.TableCTViewModel>
@{
    Layout = null;
    string PublicResources = "~/Views/Exams/CheckingTags/_TableCTExamPartial.cshtml";
}
<html lang="en-us" style="margin: 0;padding: 0; min-height: 100%;position: relative;font-size: 10px;font-family: sans-serif;">
<head style="">   
    <style tyle="text/css">
        .list-rotated {
            text-align: justify;
            padding: 0 1em;
        }

            .list-rotated:after {
                content: "";
                width: 100%;
                display: inline-block;
            }

            .list-rotated > li {
                display: inline-block;
                width: 0;
                line-height: 0;
            }

                .list-rotated > li > * {
                    display: inline-block;
                    white-space: nowrap;
                    transform: translate(0,100%) rotate(-90deg);
                    transform-origin: 0 0;
                    vertical-align: bottom;
                }

                    .list-rotated > li > *:before {
                        content: "";
                        float: left;
                        margin-top: 100%;
                    }
    </style>

</head>

<body style="font-family: 'Open Sans',Arial,Helvetica,Sans-Serif;color: #333;background-color: #fff;">
    <table width="100%" cellpadding="0" cellspacing="0" style="border-collapse: collapse;border-spacing: 0;">
        <tr style="display: table-row; vertical-align: inherit; border-color: inherit;">
            <td style="vertical-align: top;padding: 0; display: table-cell; vertical-align: inherit; vertical-align:top">
                <table width="100%" cellpadding="0" cellspacing="0" style="background-color: transparent; border-collapse: collapse; border-spacing: 0; display: table; border-spacing: 0;">
                    <tr style="display: table-row; vertical-align: inherit; border-color: inherit;">
                        <td style="vertical-align: top;width: 39.33333333%; min-height: 1px;padding-left: 13px; padding-right: 13px;padding: 0px 0px; display: table-cell; vertical-align: inherit;">
                            <table width="100%" cellpadding="0" cellspacing="0" style="background-color: transparent; border-collapse: collapse; border-spacing: 0; display: table; border-spacing: 0;">

                                <tr style="display: table-row; vertical-align: inherit; border-color: inherit;">
                                    <td colspan="2" style="vertical-align: top;display: table-cell; vertical-align: inherit;padding: 1px 1px;text-align:left;font-size:13px;font-weight:bold;">@Html.Resource("SchoolName", PublicResources)</td>
                                </tr>
                                <tr>
                                    <td colspan="2" style="vertical-align: top;display: table-cell; vertical-align: inherit;padding: 1px 1px;text-align:left;font-size:13px;font-weight:bold;">@Html.Resource("SchoolNameFr", PublicResources)</td>
                                </tr>
                            </table>
                        </td>
                        <td style="width: 27.33333333%; min-height: 1px;padding-left: 13px; padding-right: 13px;padding: 1px 1px; display: table-cell; vertical-align: inherit;text-align:center;"<img src="http://www.byec-edu.org/AppByec/Content/image/Corporate/logo-bey-exam1.png" style="width:40px!important; height:40px!important;"></td>
                        <td style="width: 33.33333333%; min-height: 1px;padding-left: 13px; padding-right: 13px;padding: 1px 1px; display: table-cell; vertical-align: inherit;">
                            <table width="100%" cellpadding="0" cellspacing="0" style="background-color: transparent; border-collapse: collapse; border-spacing: 0; display: table; border-spacing: 0;">
                                <tr style="display: table-row; vertical-align: inherit; border-color: inherit;">
                                    <td colspan="2" style="vertical-align: top;display: table-cell; vertical-align: inherit;text-align:right;font-size:18px;font-weight:bold;">@Html.Resource("SchoolNameAr", PublicResources)</td>
                                </tr>
                                <tr style="display: table-row; vertical-align: inherit; border-color: inherit;">
                                    <td colspan="2" style="vertical-align: top;display: table-cell; vertical-align: inherit;text-align:right;font-size:18px;font-weight:bold;">@Html.Resource("SchoolNameArAddr", PublicResources)</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr style="display: table-row; vertical-align: inherit; border-color: inherit;">
            <td class="col-md-12" style="width: 100%; float: left;position: relative; min-height: 1px;padding-left: 13px;padding-right: 13px;display: table-cell; vertical-align: inherit;padding: 1px 1px;">
                <table cellpadding="0" cellspacing="0" style="width: 100%; float: left;position: relative; min-height: 1px;padding-left: 13px;padding-right: 13px;background-color: transparent; border-collapse: collapse; border-spacing: 0; display: table; border-spacing: 0;">
                    <tr style="display: table-row; vertical-align: inherit; border-color: inherit;">
                        <td style="line-height: 1.42857143; vertical-align: top;padding: 1px 1px; display: table-cell; vertical-align: inherit;text-align:center;font-size:20px;">
                            @Html.Resource("SignExamTitle", PublicResources)  @Model[0].Class
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr><td>&nbsp;</td></tr>
        <tr style="display: table-row; vertical-align: inherit; border-color: inherit;padding: 8px 10px;">
            <td class="col-md-12" style="width: 100%; float: left;position: relative; min-height: 1px;padding-left: 13px;padding-right: 13px;display: table-cell; vertical-align: inherit;padding: 4px 5px;">
                <table cellpadding="0" cellspacing="0" class="col-md-12" style="width: 100%;">
                    <tr>
                        <td class="col-md-7" style="width: 50%;">&nbsp;</td>
                        <td class="col-md-2 font-md" style="width: 15%;text-align:right;font-size:18px;">@Model[0].Division</td>
                        <td class="col-md-1 font-md" style="width: 10%;text-align:right;font-size:18px;">@Html.Resource("Division", PublicResources)</td>
                        <td class="col-md-1 font-md" style="width: 15%;text-align:right;font-size:18px;">@Model[0].Class</td>
                        <td class="col-md-1 font-md" style="width: 10%;text-align:right;font-size:18px;">@Html.Resource("Class", PublicResources)</td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td>
                <table cellpadding="0" cellspacing="0" style="border-collapse: collapse;border-spacing: 0;width: 100%;" dir="rtl">
                    <tbody>
                        <tr>
                            <td style="width:20px"></td>
                            <td style="width:200px;"></td>
                            @for (int r = 0; r < Model[0].ItemCoursePS.Count; r++)
                            {
                                var ItemCourseData = Model[0].ItemCoursePS[r];
                                if (Model[0].ItemCoursePS[r].HasSkils == true)
                                {
                                    var ItemCourse = Model[0].ItemCoursePS[r];
                                    for (int j = 0; j < ItemCourse.ItemSkilsPS.Count; j++)
                                    {
                                        <td style="width:50px;">&nbsp;</td>
                                    }
                                    <td style="width:50px;">&nbsp;</td>
                                }
                                else
                                {
                                    <td style="width:50px;">&nbsp;</td>
                                }
                            }
                            <td style="width:50px;">&nbsp;</td>
                            <td style="width:50px;">&nbsp;</td>
                            <td style="width:50px;">&nbsp;</td>
                            <td style="width:50px;">&nbsp;</td>
                        </tr>
                        <tr>

                            <td style="border: 1px solid #ddd;border-bottom:1px solid #fff">&nbsp;</td>
                            <td colspan="1" style="border: 1px solid #ddd;border-bottom:1px solid #fff">&nbsp;</td>


                            @for (int r = 0; r < Model[0].ItemCoursePS.Count; r++)
                            {
                                var ItemCourseData = Model[0].ItemCoursePS[r];
                                if (Model[0].ItemCoursePS[r].HasSkils == true)
                                {
                                    var counter = 0;
                                    var ItemCourse = Model[0].ItemCoursePS[r];
                                    for (int j = 0; j < ItemCourse.ItemSkilsPS.Count; j++)
                                    {
                                        counter = counter + 1;
                                    }
                                    counter = counter + 1;
                                    <td colspan="@(counter)" style="border: 1px solid #ddd; border-bottom:1px solid #ddd; text-align:center">@ItemCourseData.Name</td>
                                }
                                else
                                {
                                    <td colspan="1" style="border: 1px solid #ddd; border-bottom:1px solid #fff; text-align:center"></td>
                                }
                            }



                            <td colspan="1" style="border: 1px solid #ddd;border-bottom:1px solid #fff;  text-align:center">&nbsp;</td>
                            <td colspan="1" style="border: 1px solid #ddd;border-bottom:1px solid #fff;  text-align:center">&nbsp;</td>
                            <td colspan="1" style="border: 1px solid #ddd;border-bottom:1px solid #fff;  text-align:center">&nbsp;</td>
                            <td colspan="1" style="border: 1px solid #ddd;border-bottom:1px solid #fff;  text-align:center">&nbsp;</td>
                        </tr>
                        <tr>
                            <td colspan="2" style="border: 1px solid #ddd;width:200px;text-align:center;font-size:12px; display: table-cell; vertical-align: inherit; font-size:14px;">المادة</td>
                            @for (int i = 0; i < Model[0].ItemCoursePS.Count; i++)
                            {
                                var ItemCourse = Model[0].ItemCoursePS[i];
                                if (Model[0].ItemCoursePS[i].HasSkils == true)
                                {
                                    for (int j = 0; j < ItemCourse.ItemSkilsPS.Count; j++)
                                    {
                                        <td class="list-rotated text-center" style="border: 1px solid #ddd;text-align:center;font-size:14px;height: 250px;font-weight: bold;">
                                            <li><span style="width: 0px;vertical-align:top!important;font-weight: bold;margin-top:-90px;"> @ItemCourse.ItemSkilsPS[j].Name </span></li>
                                        </td>
                                    }
                                    <td class="list-rotated text-center" style="border: 1px solid #ddd;text-align:center;font-size:14px;height: 250px;font-weight: bold;">
                                        <li style="line-height:0px!important"><span style="width: 0px;vertical-align:top!important;font-weight: bold;margin-top:-90px;">@Html.Resource("Average", PublicResources)</span></li>
                                    </td>

                                }
                                else
                                {
                                    <td class="list-rotated text-center" style="border: 1px solid #ddd;text-align:center;font-size:14px;height: 250px;font-weight: bold;">
                                        <li><span style="width: 0px;vertical-align:top!important;font-weight: bold;margin-top:-90px;"> @Model[0].ItemCoursePS[i].Name </span></li>
                                    </td>
                                }
                            }
                            <td class="list-rotated text-center" style="border: 1px solid #ddd;text-align:center;font-size:14px;height: 250px;font-weight: bold;">
                                <li><span style="width: 0px;vertical-align:top!important;font-weight: bold;margin-top:-90px;"> @Html.Resource("GeneralTotal", PublicResources) </span></li>
                            </td>
                            <td class="list-rotated text-center" style="border: 1px solid #ddd;text-align:center;font-size:14px;height: 250px;font-weight: bold;">
                                <li><span style="width: 0px;vertical-align:top!important;font-weight: bold;margin-top:-90px;"> @Html.Resource("GeneralAverage", PublicResources)</span></li>
                            </td>
                            <td class="list-rotated text-center" style="border: 1px solid #ddd;text-align:center;font-size:14px;height: 250px;font-weight: bold;">
                                <li><span style="width: 0px;vertical-align:top!important;font-weight: bold;margin-top:-90px;"> @Html.Resource("Category", PublicResources)</span></li>
                            </td>
                            <td class="list-rotated text-center" style="border: 1px solid #ddd;text-align:center;font-size:14px;height: 250px;font-weight: bold;">
                                <li><span style="width: 0px;vertical-align:top!important;font-weight: bold;margin-top:-90px;"> @Html.Resource("Result", PublicResources)</span></li>
                            </td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd;font-size:14px;text-align:center;">#</td>
                            <td style="border: 1px solid #ddd;width:200px;text-align:center; font-size:20px;">الطالب</td>
                            @for (int r = 0; r < Model[0].ItemCoursePS.Count; r++)
                            {
                                var ItemCourseData = Model[0].ItemCoursePS[r];
                                if (Model[0].ItemCoursePS[r].HasSkils == true)
                                {
                                    var ItemCourse = Model[0].ItemCoursePS[r];
                                    for (int j = 0; j < ItemCourse.ItemSkilsPS.Count; j++)
                                    {
                                        <td style="border: 1px solid #ddd;text-align:center;font-size:12px; display: table-cell; vertical-align: inherit;">@ItemCourseData.ItemSkilsPS[j].MaximumMark</td>
                                    }
                                    <td style="border: 1px solid #ddd;text-align:center;font-size:12px; display: table-cell; vertical-align: inherit;">@ItemCourseData.ItemSkilsPS[0].Total</td>
                                }
                                else
                                {
                                    <td style="border: 1px solid #ddd;text-align:center;font-size:12px; display: table-cell; vertical-align: inherit;">@ItemCourseData.ItemSkilsPS[0].Total</td>
                                }
                            }


                            <td style="border: 1px solid #ddd;text-align:center;font-size:12px; display: table-cell; vertical-align: inherit;">@Model[0].MAximunCoefficeint</td>
                            <td style="border: 1px solid #ddd;text-align:center;font-size:12px; display: table-cell; vertical-align: inherit;">&nbsp;</td>
                            <td style="border: 1px solid #ddd;text-align:center;font-size:12px; display: table-cell; vertical-align: inherit;">&nbsp;</td>
                            <td style="border: 1px solid #ddd;text-align:center;font-size:12px; display: table-cell; vertical-align: inherit;">&nbsp;</td>
                        </tr>


                        @for (int f = 0; f < Model.Count; f++)
                        {
                            <tr>
                                <td style="border: 1px solid #ddd;font-size:14px;text-align:center;">@Model[f].NumberStudent</td>
                                <td style="border: 1px solid #ddd;width:200px;text-align:center; font-size:14px;">@Model[f].NameStudent</td>
                                @for (int t = 0; t < Model[f].ItemCoursePS.Count; t++)
                                {
                                    var ItemCourseData = Model[f].ItemCoursePS[t];

                                    if (Model[f].ItemCoursePS[t].HasSkils == true)
                                    {
                                        decimal subTotal = 0;
                                        for (int j = 0; j < ItemCourseData.ItemSkilsPS.Count; j++)
                                        {
                                            if (ItemCourseData.ItemSkilsPS[j].Average != null && ItemCourseData.ItemSkilsPS[j].Average != "")
                                            {
                                                subTotal = Convert.ToDecimal(subTotal) + Convert.ToDecimal(ItemCourseData.ItemSkilsPS[j].Average);
                                            }
                                            else
                                            {
                                                subTotal = Convert.ToDecimal(subTotal);
                                            }

                                            <td style="border: 1px solid #ddd;text-align:center;font-size:12px; display: table-cell; vertical-align: inherit;">@ItemCourseData.ItemSkilsPS[j].Average</td>
                                        }
                                        <td style="border: 1px solid #ddd;text-align:center;font-size:12px; display: table-cell; vertical-align: inherit;">@subTotal</td>
                                    }
                                    else
                                    {
                                        <td style="border: 1px solid #ddd;text-align:center;font-size:12px; display: table-cell; vertical-align: inherit;">@ItemCourseData.ItemSkilsPS[0].Average</td>
                                    }
                                }




                                <td style="border: 1px solid #ddd;text-align:center;font-size:12px; display: table-cell; vertical-align: inherit;">@Model[f].AgerageAllSemester</td>
                                <td style="border: 1px solid #ddd;text-align:center;font-size:12px; display: table-cell; vertical-align: inherit;">@Model[f].CoefficientAgerageAllSemester</td>
                                <td style="border: 1px solid #ddd;text-align:center;font-size:12px; display: table-cell; vertical-align: inherit;">@Model[f].ratingAgerageAllSemester</td>
                                <td style="border: 1px solid #ddd;text-align:center;font-size:12px; display: table-cell; vertical-align: inherit;">@Model[f].resultAgerageAllSemester</td>
                            </tr>
                        }

                    </tbody>
                </table>
            </td>

        </tr>
    </table>
</body>
</html>

